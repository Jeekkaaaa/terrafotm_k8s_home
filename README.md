# üöÄ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –¥–µ–ø–ª–æ–π Kubernetes –∫–ª–∞—Å—Ç–µ—Ä–∞ –Ω–∞ Proxmox

**–ü–æ–ª–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è K8s –∫–ª–∞—Å—Ç–µ—Ä–∞ —á–µ—Ä–µ–∑ Terraform –∏ Git CI/CD.**

---

## üìã –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ
- [üéØ –û—Å–Ω–æ–≤–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏](#-–æ—Å–Ω–æ–≤–Ω—ã–µ-–≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏)
- [üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞](#Ô∏è-–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞)
- [üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞](#-—Å—Ç—Ä—É–∫—Ç—É—Ä–∞-–ø—Ä–æ–µ–∫—Ç–∞)
- [‚öôÔ∏è –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞](#Ô∏è-–ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–∞—è-–Ω–∞—Å—Ç—Ä–æ–π–∫–∞)
- [üîê –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Å–µ–∫—Ä–µ—Ç–æ–≤ CI/CD](#-–Ω–∞—Å—Ç—Ä–æ–π–∫–∞-—Å–µ–∫—Ä–µ—Ç–æ–≤-cicd)
- [üõ†Ô∏è –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π —Ñ–∞–π–ª](#Ô∏è-–∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π-—Ñ–∞–π–ª)
- [üöÄ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ](#-–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ)
- [üîß –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –Ω–µ–ø–æ–ª–∞–¥–æ–∫](#-—É—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ-–Ω–µ–ø–æ–ª–∞–¥–æ–∫)
- [üîÑ Workflow –ø—Ä–æ—Ü–µ—Å—Å](#-workflow-–ø—Ä–æ—Ü–µ—Å—Å)

---

## üéØ –û—Å–Ω–æ–≤–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

‚úÖ **–ü–æ–ª–Ω–∞—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è** ‚Äî –æ—Ç —à–∞–±–ª–æ–Ω–∞ –¥–æ —Ä–∞–±–æ—Ç–∞—é—â–µ–≥–æ –∫–ª–∞—Å—Ç–µ—Ä–∞  
‚úÖ **UEFI –∑–∞–≥—Ä—É–∑–∫–∞** ‚Äî —Å–æ–≤—Ä–µ–º–µ–Ω–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –≤—Å–µ—Ö –í–ú  
‚úÖ **–ê–≤—Ç–æ–ø–æ–¥–±–æ—Ä IP** ‚Äî —É–º–Ω—ã–π –ø–æ–∏—Å–∫ —Å–≤–æ–±–æ–¥–Ω—ã—Ö –∞–¥—Ä–µ—Å–æ–≤  
‚úÖ **–ì–∏–±–∫–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è** ‚Äî –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –Ω–æ–¥ —á–µ—Ä–µ–∑ –æ–¥–∏–Ω —Ñ–∞–π–ª  
‚úÖ **CI/CD –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è** ‚Äî –¥–µ–ø–ª–æ–π –ø–æ push –≤ Git  
‚úÖ **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å** ‚Äî SSH –∫–ª—é—á–∏ —á–µ—Ä–µ–∑ —Å–µ–∫—Ä–µ—Ç—ã, API —Ç–æ–∫–µ–Ω—ã  

---
## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

terrafotm_k8s_home/
‚îú‚îÄ‚îÄ .gitea/
‚îÇ   ‚îî‚îÄ‚îÄ workflows/
‚îÇ       ‚îî‚îÄ‚îÄ deploy-master.yml    # CI/CD –ø–∞–π–ø–ª–∞–π–Ω
‚îú‚îÄ‚îÄ config.auto.tfvars           # –û—Å–Ω–æ–≤–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îú‚îÄ‚îÄ variables.tf                 # –û–±—â–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ Terraform
‚îú‚îÄ‚îÄ template/                    # –®–∞–±–ª–æ–Ω –í–ú (9001)
‚îÇ   ‚îú‚îÄ‚îÄ main.tf                  
‚îÇ   ‚îî‚îÄ‚îÄ variables.tf
‚îú‚îÄ‚îÄ master/                      # Master –Ω–æ–¥—ã
‚îÇ   ‚îú‚îÄ‚îÄ main.tf                 # Terraform –¥–ª—è master
‚îÇ   ‚îî‚îÄ‚îÄ variables.tf
‚îî‚îÄ‚îÄ worker/                      # Worker –Ω–æ–¥—ã
    ‚îú‚îÄ‚îÄ main.tf                 # Terraform –¥–ª—è workers
    ‚îî‚îÄ‚îÄ variables.tf

## ‚öôÔ∏è –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞

1. –°–æ–∑–¥–∞–Ω–∏–µ API —Ç–æ–∫–µ–Ω–∞ –≤ Proxmox
```# –ù–∞ Proxmox —Ö–æ—Å—Ç–µ (192.168.0.—Ö—Ö—Ö):
pveum user add terraform --password <–≤–∞—à_–ø–∞—Ä–æ–ª—å>
pveum role add terraform -privs "VM.Allocate VM.Audit VM.Clone VM.Config.CDROM VM.Config.CPU VM.Config.Cloudinit VM.Config.Disk VM.Config.Memory VM.Config.Network VM.Config.Options VM.Config.HWType VM.GuestAgent.Audit VM.GuestAgent.Unrestricted Sys.Audit VM.PowerMgmt Datastore.Allocate Datastore.Audit Datastore.AllocateSpace User.Modify Permissions.Modify SDN.Use SDN.Audit Pool.Allocate Pool.Audit Sys.Console Sys.Modify VM.Migrate"
pveum aclmod / -user terraform -role TerraformProv
pveum token add terraform-token --user terraform-prov@pve --privsep 0
```

–ó–∞–ø–∏—à–∏—Ç–µ:

Token ID: terraform-prov@pve!terraform-token

Token Secret: —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π UUID

2. –°–æ–∑–¥–∞–Ω–∏–µ SSH –∫–ª—é—á–∞



